<html>

<head>
    <!-- <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;" /> -->
    <script src="src/html5-qrcode.min.js"></script>
</head>

<body>
    <div style="width: 500px" id="reader"></div>

    <div id="qr-result" hidden="">
        <b>Data:</b> <span id="outputData"></span>
    </div>

    <script>

        // This method will trigger user permissions
        Html5Qrcode.getCameras().then(devices => {
        /**
         * devices would be an array of objects of type:
         * { id: "id", label: "label" }
         */
        if (devices && devices.length) {
            var cameraId = devices[0].id;
            
            const html5QrCode = new Html5Qrcode(/* element id */ "reader");
            html5QrCode.start(
            cameraId, 
            {
                fps: 10,    // Optional frame per seconds for qr code scanning
                qrbox: 250  // Optional if you want bounded box UI
            },
            qrCodeMessage => {
                // do something when code is read
                onScanSuccess(qrCodeMessage)
            },
            errorMessage => {
                // parse error, ignore it.
            })
            .catch(err => {
            // Start failed, handle it.
            });
        }
        }).catch(err => {
        // handle err
        });

        function onScanSuccess(qrCodeMessage) {
            // handle on success condition with the decoded message
            if (qrCodeMessage) {
                outputData.innerText = qrCodeMessage;
            }

            html5QrcodeScanner.clear();
            // ^ this will stop the scanner (video feed) and clear the scan area.
        }

        var html5QrcodeScanner = new Html5QrcodeScanner(
            "reader", { fps: 10, qrbox: 250 });
        html5QrcodeScanner.render(onScanSuccess);

    </script>
</body>

</html>